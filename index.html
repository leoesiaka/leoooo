<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday — Heart Animation</title>
  <style>
    :root{
      --bg1:#0f172a;
      --bg2:#1f2937;
      --accent:#ff4d6d;
      --accent-2:#ff7aa2;
      --glass: rgba(255,255,255,0.06);
      --glass-2: rgba(255,255,255,0.04);
      --font: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:var(--font);background:radial-gradient(1200px 600px at 10% 10%, rgba(255,77,109,0.06), transparent), linear-gradient(180deg,var(--bg1),var(--bg2));color:#fff;}

    .stage{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
      overflow:hidden;
      position:relative;
    }

    .card{
      width:min(980px,96%);
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:18px;
      padding:28px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6);
      position:relative;
      backdrop-filter: blur(6px);
      display:grid;
      grid-template-columns: 440px 1fr;
      gap:20px;
      align-items:center;
    }

    .left{
      display:flex;flex-direction:column;align-items:center;gap:16px;padding:12px;
    }
    .heart-wrap{width:360px;height:320px;display:flex;align-items:center;justify-content:center;position:relative}

    .heart{
      width:240px;height:240px;filter:drop-shadow(0 18px 30px rgba(255,77,109,0.18));
      transform-origin:center center;
      animation:heartbeat 1s infinite cubic-bezier(.25,.9,.32,1);
    }
    @keyframes heartbeat{
      0%{transform:scale(1)}
      20%{transform:scale(1.08)}
      40%{transform:scale(0.98)}
      60%{transform:scale(1.06)}
      100%{transform:scale(1)}
    }

    .heart .glow{mix-blend-mode:screen;opacity:0.9;filter:blur(14px)}

    .right{padding:14px}
    h1{margin:0;font-size:28px;letter-spacing:0.2px}
    p.lead{margin:8px 0 18px;color:rgba(255,255,255,0.86)}

    .message-box{
      background:linear-gradient(180deg,var(--glass),var(--glass-2));border-radius:12px;padding:18px;min-height:140px;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden
    }
    .typed{font-size:20px;line-height:1.4;max-width:100%;text-align:center}

    .controls{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap;justify-content:center}

    .btn{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:8px 12px;border-radius:10px;color:#fff;cursor:pointer;backdrop-filter: blur(4px)}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none}

    .particles{position:absolute;inset:0;pointer-events:none}
    .note{font-size:12px;color:rgba(255,255,255,0.6);margin-top:14px;text-align:center}

    @media (max-width:880px){
      .card{grid-template-columns:1fr;}
      .heart{width:180px;height:180px}
      .heart-wrap{height:260px}
    }

    .spark{position:absolute;width:6px;height:6px;border-radius:50%;opacity:0.0;transform:translate(-50%,-50%) scale(0.6);animation:spark 2.6s linear infinite}
    @keyframes spark{0%{opacity:0;transform:translate(-50%,-50%) scale(0.2)}10%{opacity:1}100%{opacity:0;transform:translate(-50%, -600%) scale(1.2)}}
    .actions{display:flex;gap:8px;justify-content:center;margin-top:12px}
    @media (min-width: 321px) and (max-width: 540px) {
  html, body {
    min-height: 100%;
    background-attachment: fixed; /* Keeps gradient full height */
  }

  .stage {
    min-height: 100%;
    padding: 16px;
    align-items: flex-start; /* Prevents forced centering if taller */
  }

  .card {
    grid-template-columns: 1fr;
    padding: 18px;
    gap: 14px;
  }

  .heart-wrap {
    width: 260px;
    height: 220px;
  }

  .heart {
    width: 150px;
    height: 150px;
  }

  h1 {
    font-size: 22px;
    text-align: center;
  }

  p.lead {
    font-size: 16px;
    text-align: center;
  }

  .message-box {
    padding: 14px;
    min-height: 120px;
  }

  .typed {
    font-size: 18px;
  }

  .btn {
    padding: 6px 10px;
    font-size: 14px;
  }

  .note {
    font-size: 11px;
    text-align: center;
    padding: 0 6px;
  }
}

  </style>
</head>
<body>
  <div class="stage">
    <div class="card" role="main">
      <div class="left">
        <div class="heart-wrap" aria-hidden>
          <svg class="heart" viewBox="0 0 32 29" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="g1" x1="0" x2="1">
                <stop offset="0%" stop-color="#ff6b8a"/>
                <stop offset="100%" stop-color="#ff2d6f"/>
              </linearGradient>
            </defs>
            <path d="M23.6 1.9c-2.5 0-4.3 1.6-5.6 3-1.3-1.4-3.1-3-5.6-3C6 1.9 1 6.4 1 12.1c0 6.1 7.5 10.9 14.7 15.3 1.1.7 2.4.7 3.5 0C23.5 23 31 18.2 31 12.1 31 6.4 26 1.9 23.6 1.9z" fill="url(#g1)"/>
            <path class="glow" d="M23.6 1.9c-2.5 0-4.3 1.6-5.6 3-1.3-1.4-3.1-3-5.6-3C6 1.9 1 6.4 1 12.1c0 6.1 7.5 10.9 14.7 15.3 1.1.7 2.4.7 3.5 0C23.5 23 31 18.2 31 12.1 31 6.4 26 1.9 23.6 1.9z" fill="#ff7aa2" opacity="0.2"/>
          </svg>
        </div>

        <div class="actions">
          <button class="btn primary" id="sendHeart">Send A Heart</button>
          <button class="btn" id="toggleBeat">Pause Beat</button>
        </div>
        <div class="note">Tip: click "Send A Heart" to sprinkle floating hearts. Long-press (on mobile) to keep sending.</div>
      </div>

      <div class="right">
        <h1>Happy Birthday 🎉</h1>
        <p class="lead">A little something made with <span style="color:var(--accent)">love</span> — click to interact or let it play.</p>

        <div class="message-box">
          <div class="typed" id="typed">Loading message...</div>
        </div>

      </div>

      <div class="particles" id="particles"></div>
    </div>
  </div>

  <script>
    const particles = document.getElementById('particles');
    const heartSVG = document.querySelector('.heart');
    const sendBtn = document.getElementById('sendHeart');
    const toggleBtn = document.getElementById('toggleBeat');
    const typedEl = document.getElementById('typed');

    function defaultMessages(){
      return [
        `Dear my wife,`,
        `Today is all about you — your smile, your laugh, your heart.`,
        `I wanted to wrap the whole world in a hug but this will have to do ❤️`,
        `Happy birthday, my wife! May your day be as bright as you make my life.`
      ];
    }

    async function typeSequence(lines, el){
      el.innerHTML='';
      for(const line of lines){
        await typeLine(line, el);
        await wait(600);
        const br = document.createElement('div');
        el.appendChild(br);
      }
    }
    function typeLine(text, el){
      return new Promise(resolve =>{
        let i=0;
        const span = document.createElement('span');
        el.appendChild(span);
        const t = setInterval(()=>{
          span.textContent += text[i++] || '';
          if(i>text.length){clearInterval(t);resolve();}
        }, 36);
      });
    }
    function wait(ms){return new Promise(r=>setTimeout(r,ms));}

    function spawnHeart(x, y, color){
      const el = document.createElement('div');
      el.className='spark';
      const size = 8 + Math.random()*18;
      el.style.width = size+'px';
      el.style.height = size+'px';
      el.style.left = x+'px';
      el.style.top = y+'px';
      el.style.background = color || 'linear-gradient(90deg,#ff6b8a,#ff2d6f)';
      el.style.boxShadow = '0 6px 18px rgba(255,77,109,0.16)';
      particles.appendChild(el);
      el.style.animationDuration = (1.6 + Math.random()*2.4)+'s';
      setTimeout(()=>el.remove(),6000);
    }

    function spawnHeartSVG(clientX, clientY){
      const box = particles.getBoundingClientRect();
      const x = clientX - box.left;
      const y = clientY - box.top;
      const svgNS = 'http://www.w3.org/2000/svg';
      const s = document.createElementNS(svgNS,'svg');
      s.setAttribute('viewBox','0 0 32 29');
      s.setAttribute('width', 24 + Math.random()*32);
      s.setAttribute('height', 24 + Math.random()*32);
      s.style.position='absolute';
      s.style.left = (x - 20 + Math.random()*40)+'px';
      s.style.top = (y - 10 + Math.random()*30)+'px';
      s.style.opacity = '0.95';
      s.style.transform = `translateY(0px)`;
      s.style.transition = `transform 2.6s ease-out, opacity 2.6s ease-out`;
      s.innerHTML = `<path d="M23.6 1.9c-2.5 0-4.3 1.6-5.6 3-1.3-1.4-3.1-3-5.6-3C6 1.9 1 6.4 1 12.1c0 6.1 7.5 10.9 14.7 15.3 1.1.7 2.4.7 3.5 0C23.5 23 31 18.2 31 12.1 31 6.4 26 1.9 23.6 1.9z" fill="#ff6b8a" />`;
      particles.appendChild(s);
      requestAnimationFrame(()=>{
        s.style.transform = `translateY(-220px) rotate(${(Math.random()*80)-40}deg) scale(${0.9+Math.random()*0.8})`;
        s.style.opacity='0';
      });
      setTimeout(()=>s.remove(),3200);
    }

    sendBtn.addEventListener('click', e=>{
      const box = particles.getBoundingClientRect();
      const cx = box.width/2;
      const cy = box.height*0.45;
      for(let i=0;i<10;i++){
        setTimeout(()=>spawnHeartSVG(cx + (Math.random()*160-80), cy + (Math.random()*40-20)), i*80);
      }
    });

    let longPressTimer;
    sendBtn.addEventListener('pointerdown', ()=>{
      longPressTimer = setInterval(()=> sendBtn.click(), 450);
    });
    ['pointerup','pointerleave','pointercancel'].forEach(ev=>sendBtn.addEventListener(ev, ()=>{clearInterval(longPressTimer);}));

    let beating = true;
    toggleBtn.addEventListener('click', ()=>{
      beating = !beating;
      heartSVG.style.animationPlayState = beating ? 'running':'paused';
      toggleBtn.textContent = beating ? 'Pause Beat':'Resume Beat';
    });

    document.querySelector('.card').addEventListener('click',(e)=>{
      if(e.target.closest('button')) return;
      spawnHeartSVG(e.clientX,e.clientY);
    });

    async function init(){
      const lines = defaultMessages();
      await typeSequence(lines, typedEl);
    }
    init();

    (function ambientSparks(){
      setInterval(()=>{
        const w = particles.clientWidth || window.innerWidth;
        const h = particles.clientHeight || window.innerHeight;
        const x = Math.random()*w;
        const y = h*0.85 + Math.random()*h*0.15;
        spawnHeart(x,y);
      },420);
    })();

    document.addEventListener('keydown', (e)=>{
      if(e.code === 'Space'){
        e.preventDefault(); sendBtn.click();
      }
    });
  </script>
</body>
</html>
